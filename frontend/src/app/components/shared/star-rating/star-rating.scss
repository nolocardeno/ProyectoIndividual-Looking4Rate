@use 'styles/00-settings/variables' as *;

// ==========================================================================
// STAR RATING COMPONENT
// Componente de puntuación con estrellas CSS puras
// ==========================================================================

:host {
  display: block;
}

.star-rating {
  display: flex;
  align-items: center;
  gap: $spacing-1;

  // --------------------------------------------------------------------------
  // ESTRELLA INDIVIDUAL (CSS puro)
  // --------------------------------------------------------------------------
  &__star {
    appearance: none;
    background: transparent;
    border: none;
    padding: 0;
    margin: 0;
    cursor: pointer;
    transition: transform $transition-fast $transition-ease;

    &:hover:not(:disabled) {
      transform: scale(1.1);
    }

    &:focus-visible {
      outline: 2px solid var(--color-accent);
      outline-offset: 2px;
      border-radius: $radius-sm;
    }

    // Deshabilitado (modo readonly)
    &:disabled {
      cursor: default;
      
      &:hover {
        transform: none;
      }
    }
  }

  // --------------------------------------------------------------------------
  // ICONO DE ESTRELLA CSS
  // --------------------------------------------------------------------------
  &__icon {
    display: block;
    position: relative;
    transition: filter $transition-fast $transition-ease;
    
    // Borde de la estrella (pseudo-elemento más grande)
    &::before {
      content: '';
      position: absolute;
      top: -$border-medium;
      left: -$border-medium;
      width: calc(100% + #{$border-medium * 2});
      height: calc(100% + #{$border-medium * 2});
      background: $color-text-alt-dark;
      clip-path: polygon(
        50% 0%,
        61% 35%,
        98% 35%,
        68% 57%,
        79% 91%,
        50% 70%,
        21% 91%,
        32% 57%,
        2% 35%,
        39% 35%
      );
      transition: background $transition-fast $transition-ease;
    }
    
    // Fondo de la estrella
    &::after {
      content: '';
      display: block;
      width: 100%;
      height: 100%;
      position: relative;
      background: linear-gradient(180deg, $color-primary-dark 0%, $color-secondary-dark 100%);
      clip-path: polygon(
        50% 0%,
        61% 35%,
        98% 35%,
        68% 57%,
        79% 91%,
        50% 70%,
        21% 91%,
        32% 57%,
        2% 35%,
        39% 35%
      );
      transition: background $transition-fast $transition-ease;
    }
  }

  // Estado HOVER: degradado verde con sombra (colores de Figma)
  &__star--hover &__icon {
    filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.4));
  }

  // Borde en hover: degradado de color-text-alt-dark 100% a 10%
  &__star--hover &__icon::before {
    background: linear-gradient(180deg, $color-text-alt-dark 0%, rgba($color-text-alt-dark, 0.1) 100%);
  }

  // Fondo en hover: degradado
  &__star--hover &__icon::after {
    background: linear-gradient(180deg, rgba($color-secondary-dark, 0) 0%, $color-accent-dark 10%, $color-primary-dark 80%);
  }

  // Estado ACTIVO/SELECCIONADO: degradado verde brillante con sombra
  &__star--active &__icon {
    filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.4));
  }

  // Borde activo: degradado de color-text-alt-dark
  &__star--active &__icon::before {
    background: linear-gradient(180deg, $color-text-alt-dark 0%, rgba($color-text-alt-dark, 0.1) 100%);
  }

  // Fondo activo: primary-dark a accent-dark
  &__star--active &__icon::after {
    background: linear-gradient(180deg, $color-primary-dark 0%, $color-accent-dark 60%);
  }

  // Animación al seleccionar
  &__star--active &__icon::before {
    animation: starPulse 0.3s ease-out;
  }

  // --------------------------------------------------------------------------
  // MODIFICADOR: Solo lectura
  // --------------------------------------------------------------------------
  &--readonly {
    pointer-events: none;
  }

  // --------------------------------------------------------------------------
  // TAMAÑOS
  // --------------------------------------------------------------------------
  &--sm {
    gap: $spacing-1 * 0.7;

    .star-rating__icon {
      width: $spacing-2 * 0.625;
      height: $spacing-2 * 0.625;
    }
  }

  &--base {
    gap: $spacing-1 * 0.7;

    .star-rating__icon {
      width: $spacing-3 * 0.7;
      height: $spacing-3 * 0.7;
    }
  }

  &--md {
    gap: $spacing-1;

    .star-rating__icon {
      width: $spacing-3;
      height: $spacing-3;
    }
  }

  &--lg {
    gap: $spacing-1 * 1.2;

    .star-rating__icon {
      width: $spacing-3 * 1.17;
      height: $spacing-3 * 1.17;
    }
  }
}

// ==========================================================================
// ANIMACIÓN
// ==========================================================================
@keyframes starPulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.25);
  }
  100% {
    transform: scale(1);
  }
}

// ==========================================================================
// RESPONSIVE
// ==========================================================================

@media (max-width: $breakpoint-sm) {
  .star-rating {
    &--md {
      .star-rating__icon {
        width: $spacing-2; // 16px
        height: $spacing-2;
      }
    }

    &--lg {
      .star-rating__icon {
        width: $spacing-2 * 1.25; // 20px
        height: $spacing-2 * 1.25;
      }
    }
  }
}
